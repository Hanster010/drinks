<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Edge Rooftop ‚Ä¢ Drink Finder (refined)</title>
<style>
  :root{
    --bg:#FFF8EE;--card:#FFFFFF;--ink:#1A1612;--muted:#756a5e;
    --brand:#EA8E68;--brand-2:#5CC1B5;--accent:#F3C99D;
    --border:#EADFD0;--shadow:0 10px 26px rgba(0,0,0,.08);
    --r:18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    color:var(--ink);
    background:linear-gradient(180deg,var(--bg),#fff);
    font-size:18px; /* bigger base */
    line-height:1.35;
  }
  .app{max-width:520px;margin:0 auto;min-height:100svh;display:flex;flex-direction:column}
  header{position:sticky;top:0;background:rgba(255,255,255,.88);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:5}
  .brand{display:flex;align-items:center;gap:.7rem;padding:16px}
  .logo{width:30px;height:30px;border-radius:10px;background:conic-gradient(from 210deg,var(--brand),var(--accent));box-shadow:var(--shadow)}
  .title{font-weight:800;font-size:20px}
  .subtitle{font-size:13px;color:var(--muted)}
  main{flex:1;padding:18px 14px 28px}
  .card{background:#fff;border:1px solid var(--border);border-radius:var(--r);box-shadow:var(--shadow);padding:18px}
  .hero{ text-align:center; padding:22px 16px; background:
        radial-gradient(130px 70px at 85% -10%,rgba(234,142,104,.18),transparent 60%),
        radial-gradient(160px 80px at -10% 0,rgba(92,193,181,.18),transparent 60%), #fff;
        border:1px dashed var(--border); border-radius:var(--r);}
  .pill{display:inline-flex;align-items:center;gap:.5rem;border:1px solid var(--border);padding:.5rem .8rem;border-radius:999px;font-size:13px;color:var(--muted);background:#fff}
  .cta{margin-top:14px;display:grid;gap:10px;grid-template-columns:1fr 1fr}
  button{appearance:none;border:0;border-radius:14px;padding:16px;font-weight:800;background:var(--brand);color:#fff;box-shadow:var(--shadow);cursor:pointer;transition:transform .08s ease}
  button:active{transform:scale(.98)}
  button.secondary{background:#fff;color:var(--ink);border:1px solid var(--border)}
  .progress{height:10px;background:#F3E7D8;border-radius:999px;overflow:hidden;margin:12px 0}
  .fill{height:100%;width:0;background:linear-gradient(90deg,var(--brand),var(--brand-2));transition:width .45s cubic-bezier(.22,.61,.36,1)}
  .topbar{display:flex;align-items:center;gap:10px}
  .q-title{font-weight:900;font-size:22px}
  .meta{font-size:14px;color:var(--muted)}
  .chips{display:flex;flex-wrap:wrap;gap:12px;margin-top:12px}
  .chip{padding:12px 16px;border-radius:999px;border:1px solid var(--border);background:#fff;font-weight:700;cursor:pointer}
  .chip[data-active="true"]{background:var(--brand);color:#fff;border-color:var(--brand)}
  .tiles{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px}
  .tile{border:1px solid var(--border);border-radius:14px;padding:16px;display:flex;flex-direction:column;gap:8px;align-items:flex-start;background:#fff;cursor:pointer}
  .tile strong{font-size:18px}
  .tile[data-active="true"]{outline:3px solid var(--brand);background:#fff7f1}
  .nav{display:flex;gap:10px;margin-top:16px}
  .result{display:flex;gap:14px;align-items:flex-start;border:1px solid var(--border);padding:14px;border-radius:14px;background:#fff}
  .avatar{width:52px;height:52px;border-radius:12px;background:radial-gradient(60px 40px at 70% 20%, rgba(234,142,104,.5), transparent 60%), #FFEFE4;display:grid;place-items:center;font-weight:800}
  .badge{font-size:12px;border:1px solid var(--border);padding:4px 8px;border-radius:999px}
  .price{font-weight:900}
  .scorebar{height:8px;background:#F3E7D8;border-radius:999px;overflow:hidden}
  .scorebar > span{display:block;height:100%;background:linear-gradient(90deg,var(--brand),var(--brand-2))}
  .menu-link{display:block;text-align:center;margin-top:12px;font-weight:800;color:#2d615a;text-decoration:none}
  .slideIn{animation:slideIn .28s cubic-bezier(.22,.61,.36,1)}
  @keyframes slideIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  /* Bigger slider */
  input[type="range"]{width:100%;height:36px;-webkit-appearance:none;background:transparent;margin-top:8px}
  input[type="range"]::-webkit-slider-runnable-track{height:12px;background:#f0e6da;border-radius:999px;border:1px solid var(--border)}
  input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;margin-top:-10px;width:32px;height:32px;border-radius:50%;background:linear-gradient(180deg,#fff,#f7f2eb);border:2px solid var(--brand);box-shadow:0 4px 10px rgba(0,0,0,.15)}
  input[type="range"]::-moz-range-track{height:12px;background:#f0e6da;border-radius:999px;border:1px solid var(--border)}
  input[type="range"]::-moz-range-thumb{width:30px;height:30px;border-radius:50%;background:#fff;border:2px solid var(--brand)}
  /* dots */
  #dots{display:flex;gap:8px}
  #dots .dot{width:28px;height:28px;border-radius:999px;border:1px solid var(--border);background:#fff;display:grid;place-items:center;font-weight:800;cursor:pointer}
  #dots .dot[data-active="true"]{background:var(--brand);color:#fff;border-color:var(--brand)}
  /* confetti + toast */
  #confetti{position:fixed;inset:0;pointer-events:none}
  .toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:999px;font-size:14px;opacity:0;transition:opacity .25s, transform .25s;z-index:50}
  .toast.show{opacity:1;transform:translate(-50%, -4px)}
</style>
</head>
<body>
<canvas id="confetti"></canvas>
<div class="toast" id="toast">Tip: swipe ‚ü∂ Next, ‚üµ Back</div>

<div class="app" id="app">
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">Edge Rooftop</div>
        <div class="subtitle">Drink Finder ‚Ä¢ simplified interactions</div>
      </div>
    </div>
  </header>

  <main>
    <!-- Landing -->
    <section id="landing" class="grid">
      <div class="hero card slideIn">
        <div class="pill">üçπ Fresh-squeezed ‚Ä¢ Handcrafted</div>
        <h2 style="margin:10px 0 6px;font-size:24px">What are you in the mood for?</h2>
        <p class="meta">Answer a few quick questions and we‚Äôll suggest a drink you‚Äôll love.</p>
        <div class="cta">
          <button id="start">Start</button>
          <button class="secondary" id="skip">Skip to menu</button>
        </div>
      </div>
    </section>

    <!-- Wizard -->
    <section id="wizard" class="hidden">
      <div class="topbar">
        <div class="progress" style="flex:1"><div class="fill" id="prog"></div></div>
        <div id="dots"></div>
      </div>

      <div class="card slideIn" id="qCard">
        <div class="q-title" id="qTitle">Question</div>
        <div id="qBody"></div>

        <div id="peek" class="card" style="margin-top:12px;background:#fff7ed;border-style:dashed">
          <div class="meta">Live preview</div>
          <div id="peekBody" class="meta">Pick a couple options to see a suggestion‚Ä¶</div>
        </div>

        <div class="nav">
          <button class="secondary" id="back">Back</button>
          <button id="next">Next</button>
        </div>
      </div>
    </section>

    <!-- Results -->
    <section id="results" class="hidden">
      <div class="card slideIn">
        <div class="q-title">Your picks</div>
        <div id="why" class="meta" style="margin-bottom:6px"></div>
        <div id="whyChips" class="chips" style="margin-top:0"></div>
        <div id="cards" class="grid" style="margin-top:8px"></div>
        <a href="#" id="fullMenu" class="menu-link">View full menu</a>
      </div>
    </section>

    <!-- Menu -->
    <section id="menu" class="hidden">
      <div class="card slideIn">
        <div class="q-title">Full Menu (mock)</div>
        <div class="chips" id="tabs"></div>
        <div id="menuList" class="grid" style="margin-top:12px"></div>
      </div>
    </section>
  </main>

  <footer style="padding:12px;text-align:center" class="meta">Prototype mockup ¬∑ not affiliated with Edge Rooftop</footer>
</div>

<script>
(function(){
  const $=s=>document.querySelector(s);
  const vibrate=(ms=12)=>{try{navigator.vibrate&&navigator.vibrate(ms)}catch(e){}};

  // ---- DATA (same as before) ----------------------------------------------
  const MENU={
    cocktails:[
      {name:"Texas Sipper",price:16,tags:["vodka","citrus","light","bubbly","refreshing"],desc:"tito‚Äôs, elderflower, blood orange pur√©e, Topo Chico"},
      {name:"Signature Old Fashioned",price:18,tags:["whiskey","stirred","spirit-forward","classic","bitters"],desc:"Maker‚Äôs Mark, vanilla demerara, black walnut bitters"},
      {name:"Sunny Disposition",price:18,tags:["whiskey","citrus","fruit","bright"],desc:"rye, hennessy VS, blueberry, coconut, lemon"},
      {name:"Southern Belle",price:16,tags:["gin","citrus","herbal","bubbly"],desc:"Gray Whale gin, prickly pear & mint cordial, lime, yuzu soda"},
      {name:"Zilker Mule",price:16,tags:["vodka","ginger","citrus","refreshing","bubbly"],desc:"Haku vodka, mango soju cordial, lime, ginger beer"},
      {name:"Soco Marg",price:16,tags:["tequila","citrus","salt","classic"],desc:"tequila, orange, watermelon agave, lime"},
      {name:"One Flew South",price:18,tags:["mezcal","bitter","citrus","smoky"],desc:"El Tesoro, Ilegal mezcal, Suze, passionfruit, lime"},
      {name:"2nd Street Espresso Martini",price:18,tags:["vodka","coffee","sweet","creamy"],desc:"vodka, espresso liqueur, vanilla, espresso"},
      {name:"Mama Tried (Frozen)",price:15,tags:["vodka","frozen","slushy","sweet","fun"],desc:"lemon vodka, moscato, peach pur√©e, lemon"},
      {name:"El Mexicano Margarita",price:16,tags:["tequila","spicy","citrus"],desc:"jalape√±o-infused agave cordial, lime & orange"},
      {name:"Pocketful of Sunshine (NA)",price:14,tags:["na","citrus","mint","bubbly"],desc:"Ritual NA tequila, prickly pear & mint, lime, yuzu"},
      {name:"Dragon Berry Specialty (N/A)",price:12,tags:["na","tropical","sweet"],desc:"lime, orange, pineapple, dragon fruit"}
    ],
    draft:[
      {name:"ABW Pearl Snap Pilsner",price:9,tags:["beer","lager","crisp"]},
      {name:"ABW 701 Sun IPA",price:9,tags:["beer","ipa","hoppy"]},
      {name:"Zilker Icy Boys Lager",price:9,tags:["beer","lager","light"]},
      {name:"Zilker Parks & Rec Pale Ale",price:9,tags:["beer","pale","hoppy"]}
    ],
    canned:[
      {name:"Miller Light",price:8,tags:["beer","lager","light"]},
      {name:"Michelob Ultra",price:8,tags:["beer","lager","light"]},
      {name:"Live Oak Hefeweizen",price:8,tags:["beer","wheat","banana"]},
      {name:"Best Day K√∂lsch (N/A)",price:8,tags:["na","beer","kolsch"]},
      {name:"ABW Fire Eagle IPA",price:8,tags:["beer","ipa","hoppy"]},
      {name:"High Noon Black Cherry",price:8,tags:["seltzer","fruit","bubbly"]}
    ],
    wineRed:[
      {name:"Clos Du Bois Cabernet",price:14,priceBottle:56,tags:["wine","red","cabernet","smooth"]},
      {name:"Juggernaut Cabernet",price:19,priceBottle:76,tags:["wine","red","cabernet","bold"]},
      {name:"Tapiz Malbec",price:15,priceBottle:60,tags:["wine","red","malbec"]},
      {name:"Fossil Point Pinot Noir",price:14,priceBottle:56,tags:["wine","red","pinot"]},
      {name:"Banshee Red Blend",price:14,priceBottle:56,tags:["wine","red","blend"]}
    ],
    wineWhite:[
      {name:"Clos Du Bois Chardonnay",price:14,priceBottle:56,tags:["wine","white","chardonnay","buttery"]},
      {name:"Stags Leap Chardonnay",price:19,priceBottle:76,tags:["wine","white","chardonnay","rich"]},
      {name:"Scarpetta Pinot Grigio",price:14,priceBottle:56,tags:["wine","white","pinotgrigio","crisp"]},
      {name:"Whitehaven Sauvignon Blanc",price:15,priceBottle:60,tags:["wine","white","sauvblanc","zesty"]}
    ],
    bubbles:[
      {name:"Bisol Jeio Prosecco",price:14,priceBottle:56,tags:["wine","sparkling","prosecco","bubbly"]},
      {name:"Veuve Clicquot",price:150,tags:["wine","sparkling","champagne","celebration"]},
      {name:"Chandon Garden Spritz",price:17,priceBottle:68,tags:["wine","sparkling","spritz","bitter"]},
      {name:"Whispering Angel Ros√©",price:19,priceBottle:76,tags:["wine","rose","dry","light"]}
    ]
  };
  const ALL_DRINKS=[...MENU.cocktails,...MENU.draft,...MENU.canned,...MENU.wineRed,...MENU.wineWhite,...MENU.bubbles];

  // ---- QUESTIONS (updated types) ------------------------------------------
  const QUESTIONS=[
    { id:"mood", title:"Pick a vibe", type:"tiles", single:true, options:[
      {v:"refreshing", note:"citrus, bubbly, light", emoji:"üçã"},
      {v:"cozy",       note:"whiskey, stirred, espresso", emoji:"üß£"},
      {v:"fun",        note:"frozen, fruity, sweet", emoji:"üéâ"},
      {v:"adventurous",note:"mezcal, bitter, spicy", emoji:"üß≠"},
      {v:"classic",    note:"old fashioneds, margs, prosecco", emoji:"üé©"},
      {v:"zero-proof", note:"NA spirits, mint, yuzu", emoji:"ü´ß"},
    ], required:true },

    { id:"base", title:"Choose your base (up to 3)", type:"chips", multi:true, max:3,
      options:["vodka","tequila","whiskey","gin","mezcal","beer","wine","seltzer","na"], required:true },

    { id:"taste", title:"Pick up to 3 tastes", type:"chips", multi:true, max:3,
      options:["citrus","sweet","bitter","spicy","herbal","coffee","bubbly","fruit"] },

    { id:"strength", title:"How strong?", type:"slider", range:["light","balanced","spirit-forward"], required:true },

    { id:"extras", title:"Any hard no's? (tap to toggle)", type:"chips", multi:true, options:["no coffee","no spicy","no bubbles","no bitter","no sweet"] }
  ];

  // ---- APP -----------------------------------------------------------------
  const App={
    q:{step:0,answers:{}},
    show(s){["landing","wizard","results","menu"].forEach(id=>$("#"+id).classList.add("hidden")); $("#"+s).classList.remove("hidden")},
    start(){ this.q={step:0,answers:{strength:"balanced"}}; this.show("wizard"); this.renderQuestion(true); toastOnce(); },
    back(){ if(this.q.step>0){ this.q.step--; this.renderQuestion(); } else { this.show("landing"); } },
    next(){
      if(this.q.step<QUESTIONS.length-1){ this.q.step++; this.renderQuestion(); }
      else { this.show("results"); this.runMatch(); burst(); }
    },
    renderDots(){
      const d=$("#dots"); d.innerHTML="";
      QUESTIONS.forEach((_,i)=>{ const b=document.createElement("div"); b.className="dot"; b.textContent=i+1; b.dataset.active=i===this.q.step; b.onclick=()=>{this.q.step=i; this.renderQuestion(true)}; d.appendChild(b); });
    },
    renderQuestion(initial){
      $("#prog").style.width = (this.q.step)/QUESTIONS.length*100+"%";
      this.renderDots();
      const q=QUESTIONS[this.q.step]; $("#qTitle").textContent=q.title;
      const body=$("#qBody"); body.innerHTML="";
      // RENDERERS
      if(q.type==="tiles"){
        const grid=document.createElement("div"); grid.className="tiles";
        q.options.forEach(o=>{
          const div=document.createElement("button"); div.type="button"; div.className="tile";
          div.dataset.active = this.q.answers.mood===o.v;
          div.innerHTML=`<strong>${o.emoji||""} ${o.v}</strong><span class="meta">${o.note||""}</span>`;
          div.onclick=()=>{ this.q.answers.mood = (this.q.answers.mood===o.v?null:o.v); updatePeek(); this.renderQuestion(true); vibrate(); };
          grid.appendChild(div);
        });
        body.appendChild(grid);
      }
      if(q.type==="chips"){
        const wrap=document.createElement("div"); wrap.className="chips";
        const chosen=new Set(this.q.answers[q.id]||[]);
        q.options.forEach(opt=>{
          const b=document.createElement("button"); b.className="chip"; b.type="button"; b.textContent=opt;
          b.dataset.active = chosen.has(opt);
          b.onclick=()=>{
            if(q.multi){
              if(chosen.has(opt)){ chosen.delete(opt); }
              else{
                if(q.max && chosen.size>=q.max){ flashToast(`Max ${q.max}`); return; }
                chosen.add(opt);
              }
              this.q.answers[q.id]=[...chosen];
            }else{
              this.q.answers[q.id] = (this.q.answers[q.id]===opt?null:opt);
            }
            updatePeek(); this.renderQuestion(true); vibrate();
          };
          wrap.appendChild(b);
        });
        // counter
        if(q.multi){ const c=document.createElement("div"); c.className="meta"; c.style.marginTop="6px";
          c.id="counter"; c.textContent=`Selected ${chosen.size}${q.max?` / ${q.max}`:""}`; body.appendChild(wrap); body.appendChild(c);
        } else body.appendChild(wrap);
      }
      if(q.type==="slider"){
        const slider=document.createElement("input"); slider.type="range"; slider.min=0; slider.max=q.range.length-1; slider.step=1;
        const v=q.range.indexOf(this.q.answers.strength); slider.value=(v<0?1:v);
        const lab=document.createElement("div"); lab.className="meta"; lab.style.marginTop="8px";
        const EMO={light:"üòå",balanced:"üôÇ","spirit-forward":"üòÆ‚Äçüí®"};
        const upd=()=>{ const val=q.range[+slider.value]; lab.textContent=`${val} ${EMO[val]||""}`; this.q.answers.strength=val; updatePeek(); };
        slider.oninput=upd; upd(); body.appendChild(slider); body.appendChild(lab);
      }

      // nav state + validation
      const ok=this.validate(q);
      $("#next").disabled=!ok;
      $("#next").textContent = this.q.step===QUESTIONS.length-1 ? "See results" : "Next";
      if(!initial){ $("#qCard").classList.add("slideIn"); setTimeout(()=>$("#qCard").classList.remove("slideIn"),240); }
      updatePeek();
    },
    validate(q){
      if(!q.required) return true;
      const v=this.q.answers[q.id];
      if(q.type==="chips" && q.multi){ return Array.isArray(v) && v.length>0; }
      if(q.type==="tiles"){ return !!v; }
      if(q.type==="slider"){ return !!this.q.answers.strength; }
      return !!v;
    },
    scoreDrink(d){
      let score=0, why=[]; const ans=this.q.answers; const tags=d.tags||[];
      const moodMap={
        refreshing:["citrus","bubbly","light","lager","seltzer","na"],
        cozy:["whiskey","spirit-forward","stirred","espresso","malbec","pinot"],
        fun:["frozen","slushy","fruit","sweet","seltzer"],
        adventurous:["mezcal","bitter","spicy","spritz"],
        classic:["old fashioned","margarita","cabernet","sauvblanc","prosecco"],
        "zero-proof":["na"]
      };
      // base (multi)
      (ans.base||[]).forEach(b=>{ if(tags.includes(b)) { score+=22; why.push("base: "+b); }});
      if((ans.base||[]).includes("wine") && tags.includes("wine")) { score+=18; }
      if((ans.base||[]).includes("beer") && tags.includes("beer")) { score+=18; }
      if((ans.base||[]).includes("seltzer") && tags.includes("seltzer")) { score+=18; }
      if((ans.base||[]).includes("na") && tags.includes("na")) { score+=22; }

      (ans.taste||[]).forEach(t=>{ if(tags.includes(t)) { score+=10; why.push(t); } });

      if(ans.strength){
        if(ans.strength==="light" && (tags.includes("light")||tags.includes("bubbly"))) score+=8;
        if(ans.strength==="spirit-forward" && tags.includes("spirit-forward")) score+=12;
        if(ans.strength==="balanced") score+=6;
      }
      if(ans.mood){
        const m=moodMap[ans.mood]||[];
        if(m.some(t=>tags.includes(t))) { score+=10; why.push(ans.mood); }
      }
      (ans.extras||[]).forEach(x=>{
        if(x==="no coffee" && tags.includes("coffee")) score-=25;
        if(x==="no spicy" && tags.includes("spicy")) score-=25;
        if(x==="no bubbles" && tags.includes("bubbly")) score-=18;
        if(x==="no bitter" && tags.includes("bitter")) score-=18;
        if(x==="no sweet" && tags.includes("sweet")) score-=10;
      });
      return {score,why};
    },
    runMatch(){
      const ranked=ALL_DRINKS.map(d=>{const {score,why}=this.scoreDrink(d); return {...d,score,why};}).sort((a,b)=>b.score-a.score);
      const top=ranked.slice(0,3);
      const reasons=Object.entries(this.q.answers).filter(([k,v])=>v && (Array.isArray(v)?v.length:v)).map(([k,v])=>`${k}: ${Array.isArray(v)?v.join(", "):v}`).join(" ¬∑ ");
      $("#why").textContent="Based on "+(reasons||"your selections");

      $("#whyChips").innerHTML="";
      Object.entries(this.q.answers).forEach(([k,v])=>{
        (Array.isArray(v)?v:[v]).filter(Boolean).forEach(val=>{
          const s=document.createElement("span"); s.className="chip"; s.textContent=val; $("#whyChips").appendChild(s);
        });
      });

      const wrap=$("#cards"); wrap.innerHTML="";
      top.forEach(d=>{
        const badge=(d.tags||[]).includes("na")?"Zero-proof":(d.tags||[]).includes("wine")?"Wine":(d.tags||[]).includes("beer")?"Beer":"Cocktail";
        const div=document.createElement("div"); div.className="result";
        div.innerHTML=`
          <div class="avatar">üç∏</div>
          <div>
            <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
              <b style="font-size:18px">${d.name}</b>
              <span class="badge">${badge}</span>
              <span class="price">$${d.price}${d.priceBottle?` ¬∑ bottle $${d.priceBottle}`:""}</span>
            </div>
            <div class="meta" style="margin:6px 0">${d.desc||(d.tags||[]).join(" ‚Ä¢ ")}</div>
            <div class="scorebar"><span style="width:${Math.max(0,Math.min(100,50+d.score))}%"></span></div>
            <div class="meta" style="margin-top:6px">Why: ${d.why.slice(0,4).join(", ")}</div>
          </div>`;
        wrap.appendChild(div);
      });
    },
    showMenu(cat){ this.show("menu"); this.renderMenu(cat||"cocktails"); },
    renderMenu(category="cocktails"){
      const groups={cocktails:"Cocktails",draft:"Draft Beer",canned:"Canned",wineRed:"Red Wine",wineWhite:"White Wine",bubbles:"Sparkling + Ros√©"};
      const tabs=$("#tabs"); tabs.innerHTML="";
      Object.keys(groups).forEach(key=>{
        const b=document.createElement("button"); b.className="chip"; b.textContent=groups[key]; b.dataset.active=key===category;
        b.onclick=()=>{ this.renderMenu(key); vibrate(); }; tabs.appendChild(b);
      });
      const list=$("#menuList"); list.innerHTML="";
      (MENU[category]||[]).forEach(d=>{
        const row=document.createElement("div"); row.className="result";
        row.innerHTML=`<div class="avatar">ü•Ç</div>
          <div><b>${d.name}</b><div class="meta">${d.desc||(d.tags||[]).join(" ‚Ä¢ ")}</div></div>
          <div style="margin-left:auto;text-align:right"><span class="price">$${d.price}</span>${d.priceBottle?`<div class="meta">Bottle $${d.priceBottle}</div>`:""}</div>`;
        list.appendChild(row);
      });
    }
  };

  // ---- Helpers -------------------------------------------------------------
  const _score=App.scoreDrink.bind(App);
  function updatePeek(){
    const top=ALL_DRINKS.map(d=>({d,..._score(d)})).sort((a,b)=>b.score-a.score)[0];
    $("#peekBody").innerHTML = top ? `<b>${top.d.name}</b> ¬∑ $${top.d.price}<div class="meta">${(top.d.tags||[]).join(" ‚Ä¢ ")}</div>` : "‚Äî";
  }
  function flashToast(msg){ const t=$("#toast"); t.textContent=msg; t.classList.add("show"); setTimeout(()=>{t.classList.remove("show"); t.textContent="Tip: swipe ‚ü∂ Next, ‚üµ Back"},1400); }
  // confetti mini
  const canvas=$("#confetti"), ctx=canvas.getContext("2d"); let P=[]; function size(){canvas.width=innerWidth; canvas.height=innerHeight} size(); addEventListener("resize",size);
  function burst(){for(let i=0;i<80;i++){P.push({x:canvas.width/2,y:120+Math.random()*40,vx:(Math.random()-0.5)*6,vy:(Math.random()*-6-3),r:2+Math.random()*3,a:1,h:Math.random()*360});} if(!anim) anim=requestAnimationFrame(loop)}
  let anim=null; function loop(){ctx.clearRect(0,0,canvas.width,canvas.height); P.forEach(p=>{p.vy+=0.12;p.x+=p.vx;p.y+=p.vy;p.a-=0.008;ctx.fillStyle=`hsla(${p.h},80%,60%,${Math.max(0,p.a)})`;ctx.beginPath();ctx.arc(p.x,p.y,p.r,0,6.283);ctx.fill()}); P=P.filter(p=>p.a>0&&p.y<canvas.height+10); if(P.length) anim=requestAnimationFrame(loop); else{cancelAnimationFrame(anim);anim=null}}
  window.burst=burst;

  // swipe next/back on page
  let sx=0, sy=0; const area=$("#app");
  area.addEventListener("touchstart",e=>{const t=e.changedTouches[0]; sx=t.clientX; sy=t.clientY;});
  area.addEventListener("touchend",e=>{const t=e.changedTouches[0]; const dx=t.clientX-sx, dy=t.clientY-sy;
    if(Math.abs(dx)>70 && Math.abs(dy)<60 && !$("#wizard").classList.contains("hidden")){ if(dx<0) App.next(); else App.back(); }});

  document.addEventListener("keydown",e=>{ if($("#wizard").classList.contains("hidden")) return; if(e.key==="ArrowRight"||e.key==="Enter") App.next(); if(e.key==="ArrowLeft") App.back(); });

  function toastOnce(){ if(localStorage.getItem("df_toast")) return; const t=$("#toast"); t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),2400); localStorage.setItem("df_toast","1") }

  // ---- Events --------------------------------------------------------------
  $("#start").onclick=()=>{App.start(); vibrate();};
  $("#skip").onclick=()=>{App.showMenu("cocktails"); vibrate();};
  $("#back").onclick=()=>{App.back(); vibrate(8);};
  $("#next").onclick=()=>{App.next(); vibrate();};
  $("#fullMenu").onclick=(e)=>{e.preventDefault(); App.showMenu("cocktails");};

  // init
  App.show("landing");
})();
</script>
</body>
</html>
